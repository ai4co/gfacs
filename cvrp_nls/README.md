## GFACS with NLS for CVRP

Please refer to [DeepACO repository](https://github.com/henry-yeh/DeepACO) for detailed information regarding the settings.


### Prerequisites

To run GFACS, please follow the steps below to compile the shared library.
```bash
$ cd HGS-CVRP-main/
$ mkdir build
$ cd build
$ cmake .. -DCMAKE_BUILD_TYPE=Release -G "Unix Makefiles"
$ make lib
$ cd ../..
```
This will generate `libhgscvrp.so` in the `HGS-CVRP-main/build` directory.


### Dataset Generation

Generate the test datasets.  
Note that there are two types of datasets, one for our main experiments and the other for comparing with [TAM](https://openreview.net/forum?id=6ZajpxqTlQ) model. Datasets for our main experiments are provided in `.pkl` files (See [`../data/cvrp`](../data/cvrp)) and running the following command will convert them to `.pt` files. Datasets for TAM are also generated by running the following command (dataset generation code for TAM is taken from the DeepACO repository).

```raw
$ python utils.py
```
This will take up about 2GB of space.


### Training

The checkpoints will be saved in [`../pretrained/cvrp_nls`](../pretrained/cvrp_nls).

Train GFACS model for CVRP with `$N` nodes
```raw
$ python train.py $N
```

Train GFACS model for CVRP using the TAM datasets with `$N` nodes
```raw
$ python train.py $N --tam
```


### Testing

Test GFACS for CVRP with `$N` nodes
```raw
$ python test.py $N -p "path_to_checkpoint"
```

Test GFACS for CVRP using the TAM datasets with `$N` nodes
```raw
$ python test.py $N -p "path_to_checkpoint" --tam
```
